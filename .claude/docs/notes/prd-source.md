# 原始 PRD 存档

来源: text

---

## 原始需求

## 插件需求（采访细化后）

### 原始需求
# 偷菜插件 - StealFarm

一款基于实体农场世界的社交偷菜插件，玩家拥有独立地块，种植作物、偷取他人收成、布置陷阱防御，围绕"种菜—偷菜—防偷"的核心循环构建社交博弈与经济养成体验。

---

## 核心玩法

### MVP（首期必做）

**1. 农场世界与地块系统**
- 专用农场世界，玩家首次进入时自动分配一块地块，整齐排列（类似 PlotSquared 网格布局）
- 地块大小和升级上限由配置文件自定义，默认提供大型预设（初始 9x9，最大 21x21）
- 主世界设置固定传送点（NPC 或交互方块），玩家交互后传送至自己的农场
- 支持传送到其他玩家的农场（通过命令或农场世界内的导航机制）

**2. 作物种植与收获**
- 支持原版作物（小麦、胡萝卜、土豆、甜菜、南瓜、西瓜等）
- 支持自定义作物（通过配置定义，使用玩家头颅或展示框渲染），可配置生长周期、产出数量、售价
- 玩家在自己地块内正常种植、浇水（骨粉或自定义机制）、右键收割

**3. 偷菜机制**
- 玩家进入他人农场后，对成熟作物右键即可偷取
- 偷菜冷却：对同一玩家的农场有冷却时间（默认 4 小时，可配置）
- 偷取比例限制：每次只能偷走该地块成熟作物的一定比例（默认 20%-30%，可配置）
- 偷菜时产生提示（被偷方下次上线收到通知，或在线时实时通知）

**4. 经济系统**
- NPC 收购站：农场世界内设置 NPC，玩家可将作物出售，价格由配置文件固定设定
- 每种作物（含自定义作物）独立配置收购单价
- 对接主流经济插件（Vault）

**5. 好友/仇人系统（轻量版）**
- 好友关系：互相添加好友，好友可对对方农场作物浇水，加速生长（可配置加速比例）
- 仇人标记：被某玩家偷菜后自动标记为仇人，偷回仇人农场时成功率/偷取比例提升（可配置加成）
- 好友/仇人列表通过 GUI 查看管理

### 扩展功能（二期）

**6. 地块升级与功能解锁**
- 农场等级体系，消耗金币/材料升级，每级提升地块面积并解锁功能：
  - 陷阱槽位（初始 0 个，逐级解锁，上限 3 个）：可在农场内放置陷阱，偷菜者触发后受到惩罚（减速、扣金币、强制传送回自己农场等），陷阱种类可配置
  - 装饰位：解锁后可在农场放置装饰方块，纯美观
  - 防护等级：降低被偷比例上限（如 30% → 25% → 20% → 15%）
  - 自动收割（最高级解锁）：成熟作物自动收割并存入农场仓库

**7. 排行榜系统**
- 收获总量排行（种植之王）
- 偷菜总量排行（偷菜大盗）
- 金币收入排行（农场富翁）
- 被偷最少排行（铁壁农场）
- 排行榜通过命令或 GUI 查看，支持全服广播周期性榜单

**8. 成就与称号系统**
- 里程碑成就：首次种植、首次偷菜、首次被偷、收获 1000/10000 个作物、触发陷阱 10 次、连续 7 天收菜等
- 达成成就解锁称号前缀（对接聊天插件或自带前缀系统）
- 成就奖励：金币、稀有种子、装饰物品等

---

## 目标用户与使用场景

- 生存服 / 养老服 / 休闲服，玩家规模 20-200 人
- 需要社交互动玩法来提升日活和玩家粘性的服务器
- 服主希望提供一个轻松的经济产出途径，同时制造玩家间的有趣冲突

---

## 玩家交互流程

**新玩家首次体验：**
1. 玩家在主世界找到农场传送点（NPC/交互方块），交互后传送至农场世界
2. 系统自动分配一块初始地块，给予新手种子礼包
3. 玩家在地块内种植作物，等待生长（或使用骨粉/好友浇水加速）
4. 作物成熟后右键收割，前往 NPC 出售获得金币

**偷菜流程：**
1. 玩家在农场世界通过导航/命令前往其他玩家的农场
2. 看到成熟作物，右键偷取（系统自动计算可偷数量，受比例限制和冷却约束）
3. 偷取成功：作物进入背包，被偷方收到通知，偷取者记录计入排行
4. 若触发陷阱：受到对应惩罚效果

**社交流程：**
1. 通过命令/GUI 添加好友
2. 前往好友农场浇水，双方获得加速收益
3. 被偷后查看记录，系统自动标记仇人，下次偷回时获得加成

---

## 运营设计

**平衡机制：**
- 偷菜冷却 + 比例限制双重约束，防止恶意刷偷
- 防护等级升级提供被动防御，给勤劳种菜的玩家安全感
- 陷阱数量有上限，不会完全杜绝偷菜（保持博弈乐趣）

**促活手段：**
- 作物有生长周期，玩家需要定期上线收菜（不收可能被偷）
- 好友浇水机制鼓励社交互动
- 排行榜周期刷新，激发竞争
- 成就系统提供长线目标

**成就感来源：**
- 农场从小地块逐步升级为大农场的养成感
- 排行榜上榜的荣誉感
- 称号收集
- 成功偷菜/成功防偷的即时反馈快感

---

## 数据存储需求

- 玩家农场数据：地块坐标、等级、解锁功能、陷阱配置、装饰配置
- 作物数据：地块内每个作物的种类、种植时间、生长状态
- 社交数据：好友列表、仇人列表
- 偷菜记录：谁偷了谁、偷了什么、数量、时间（用于通知和排行统计）
- 经济数据：累计收入
- 统计数据：收获总量、偷菜总量、被偷总量（排行榜用）
- 成就数据：各成就完成状态与进度

---

## 权限系统

| 权限节点 | 说明 | 默认 |
|---------|------|------|
| `stealfarm.use` | 使用农场基础功能 | 所有玩家 |
| `stealfarm.steal` | 允许偷菜 | 所有玩家 |
| `stealfarm.teleport` | 传送到他人农场 | 所有玩家 |
| `stealfarm.upgrade` | 升级农场 | 所有玩家 |
| `stealfarm.admin` | 管理员命令（重置农场、修改数据等） | OP |
| `stealfarm.bypass.cooldown` | 无视偷菜冷却 | OP |
| `stealfarm.bypass.limit` | 无视偷取比例限制 | OP |

---

## 配置项需求

**农场世界配置：**
- 农场世界名称
- 地块初始大小、最大大小、地块间距
- 地块分配起始坐标和排列方向

**作物配置：**
- 每种作物的生长周期（tick）、产出数量范围、NPC 收购价
- 自定义作物定义（名称、材质/头颅值、生长阶段数）

**偷菜配置：**
- 偷菜冷却时间
- 偷取比例范围（最小/最大）
- 仇人加成比例

**升级配置：**
- 每级所需金币/材料
- 每级解锁的面积增量和功能项
- 陷阱种类定义（名称、效果、持续时间）
- 防护等级对应的被偷比例上限

**好友配置：**
- 好友上限数量
- 浇水加速比例
- 浇水冷却时间

**排行榜配置：**
- 显示数量
- 刷新周期

**成就配置：**
- 每个成就的触发条件和阈值
- 奖励内容（金币、物品、称号）

---

## 扩展性考虑

- 作物体系完全配置驱动，服主可自由添加新作物而无需改代码
- 陷阱种类可配置扩展
- 成就系统数据驱动，新增成就只需加配置
- 预留 PlaceholderAPI 变量接口（农场等级、收获总量、排行名次等）
- 预留 API 事件（种植、收获、偷菜、触发陷阱），方便其他插件联动
- 经济对接 Vault，兼容主流经济插件
- 排行榜支持对接记分板或全息显示插件

### 项目规模: 中等
### 技术栈: easylib, taboolib, vector-displays

### 需求细节

#### 核心需求
- 自定义作物的渲染方案如何实现？你提到了玩家头颅和展示框，需要明确技术路径。
  → 玩家头颅（Custom Skull Texture）：通过 base64 皮肤值渲染，生长阶段切换不同头颅，兼容性好但每阶段需独立皮肤
- 作物生长计时采用哪种技术方案？这直接影响服务器性能和离线生长的支持。
  → 真实时间戳驱动：种植时记录 Unix 时间戳，玩家加载地块时根据时间差计算生长进度，天然支持离线生长，无 tick 开销
- 农场地块的世界生成和管理方案怎么选？这决定了地块分配、边界保护和性能表现。
  → 自定义 ChunkGenerator 空世界 + 自研网格分配：完全控制地块坐标计算和边界，用 TabooLib 的世界管理工具生成 void 世界，地块间用固定间距隔离
- 数据存储层选择什么方案？需要考虑你的目标服务器规模（20-200人）和数据复杂度（作物、社交、记录等多表关联）。
  → SQLite 单文件：零配置开箱即用，适合中小服，TabooLib Database 模块原生支持，200 人规模内读写无压力

#### 主要用途
- 偷菜时的「可偷作物选择」逻辑如何设计？这影响偷菜体验的策略深度。
  → 玩家手动逐株右键：偷菜者需要逐个右键成熟作物，每次偷一株，直到达到比例上限，增加操作感和被发现的紧张感

#### 后期维护
- GUI 交互框架选用什么方案？插件涉及大量 GUI（好友管理、排行榜、成就、农场升级、陷阱配置等）。
  → EasyLib

#### 扩展开发
- API 事件系统如何设计？你提到需要预留种植、收获、偷菜、触发陷阱等事件供外部插件监听。
  → TabooLib 事件总线：使用 TabooLib 的 ProxyEvent 体系，支持跨平台抽象，但第三方插件需要理解 TabooLib 事件机制
